# IFT2015-Devoir2

[Project Instructions](https://ift2015h21.wordpress.com/2021/02/24/projet-2-nos-ancetres-communs/)

## Project Details

This project was built in Java and runs a simulation of a series of events
involving Sim populations. An age model was written describing various rates
factors which allow the generation of random lifetime durations, reproduction
waiting time, mating partners and more. The data from the simulation is then
used to plot datasets of interest such as population growth and coalescence.

## Running the application

This application can be run from the command line/terminal using the command:
```console
java -jar pedigree.jar founders maxTime
```
where the first argument is an `int` indicating the number of **founder Sims**
to be born at year 0, and the second argument is a `double` indicating the
**maximum time length** of the simulation after which the simulation will halt
if it hadn't already run out of events. Alternatively, the application can be
run simply by double-clicking the jar file.

In both cases, one will need to confirm the entered arguments in the dialog
before proceeding with the simulation.

The data from the simulation is then listed in the terminal instance if the
application was launched from the terminal and the data is plotted onto a graph
with a standard number axis for the `x` coordinates and a logarithmic axis for
the `y` coordinates.

The jFreeChart external library was used in order to plot the various datasets
of interest:
- [jFreeChart API Documentation](https://www.jfree.org/jfreechart/api/javadoc/index.html)
- [jFreeChart GitHub Repository](https://github.com/jfree/jfreechart)

## Code Details

This section will discuss more about the logic of the code and point out some
notable features.

### Age Model

The `AgeModel` class is responsible for holding the various rates and factors
of interest which influence the outcome or occurrence of certain events.
- The empty constructor serves to assign the default "human" values for the
model.
- Some notable methods are
    - `randomAge(Random)` for determining a Sim's lifespan thus configuring
    that Sim's Death Event;
    - `randomWaitingTime(Random, double)` which determines a random waiting
    time for female Sims before their next childbirth;
        - The passed double is the rate referring to the Poisson Point Process;
        this value can be calculated from the configured average offspring in
        a lifetime factor and the `expectedParenthoodSpan(double double)`
        method.

### Events

Events are defined in the `Event` class and simply consist of a subject Sim and
the time of occurrence. This class being abstract however, other classes which
extend it give more context as to the type of Event to occur. These all are
the classes `Birth`, `Death` and `Reproduction` which each call their parent's
constructor using the given parameters. Nothing else is defined in them as
their purpose is simply to distinguish from other Events as being an Event
type.

### Sims

Sims are like people in this virtual world generated by this program. They
share some common traits with us humans such as having a father and a mother,
potentially a mate of their own, a gender, a birth date and a calculated death
date. Their definition is overly simplified when comparing to actual human
beings, their definition is kept simple for the purposes of this program.
An interesting method to note is:
- `isFounder()` which indicates whether the Sim is a founder or not. There is
no theories behind how the world was created in this universe of Sims, and so
founder Sims are believed to have simply all appeared at year 0 and have been
able to grow up without any particular parental need.

### MinPQ

This class is a standard min heap structure defined generically. It serves to
order Sims by their defined or given comparison factor and order Events by
their time of occurrence. The efficient methods of insertion and suppression
make it a great data structure to use for this simulation.

### Simulation and plotting

The Simulation itself is handled by the class of the same name. It runs in a
while loop and ends once no more Events remain which indicates that the
population has all died or once the time limit is up. The class is composed of
- Various fields for holding the necessary information on Events, Sims, and
other useful factors;
- The method `simulate(n, double)` which initiates the whole process of
simulation and keeps track of the population growth over time;
- Many helper private methods which help deconstruct the various tasks of the
`simulate(n, double)` method.
    - Of these helper methods, some are worthy to note:
        - `chooseFatherSim(Event)` is responsible for selecting a male Sim from
        within the population alive at the given time. This method is mainly
        responsible for applying the default loyalty factor from the age model
        determining whether a Sim remains with their mate or changes mate for
        the reproduction event to come.
        - `getRandomMate(Event, List<Sim>)` selects a random Sim from the
        population while maintaining a list of the previously selected Sims
        so as to restore the population back to its original size after the
        selection procedure.
        - `ancestralLineage(MinPQ<Sim>, String, Map<Double, Integer>)` which
        configures the coalescences for both genders needed for plotting.
After the simulation, plotting is handled by the `SimPlot` class which
retrieves the three datasets built during the simulation. Those datasets are
then plotted and appear on a special type of `JFrame` called a `ChartFrame` via
the class' constructor. Some helper methods to note:
- The method `setSimulationParams(String, String)` retrieves the user set
parameters and checks for the input in a `JDialog`.
- The method `createDataset(DefaultXYDataset, String, Map<Double, Integer>)`
appends to the given set an additional dataset to plot. The passed String is
the dataset's name and the Map holds the value pairs to plot. Furthermore,
the value pairs are printed onto the console from this method during the data
retrieval.

## Parameters influence

This section discusses the effect of modifying the various rates and parameters
on the simulation and the plotted data. Evidently, maintaining the parameters
at their default values yields a plot closely resembling the one illustrated in
the project instructions page linked above.

### Death Rate

As one would expect, increasing the death rate shortens the Sim's lifespan
which thus often leads to prematurely ending the simulation unless the founder
population is massive enough at the beginning to stabilize itself. The set time
of the simulation greatly affects this end. Decreasing the death rate however
tends to allow smaller founder populations to sustain themselves much longer
for longer periods of time.

### Accident Rate

In a similar fashion, the modifying of this rate leads expected results. An
increase in the accident rate often prematurely ends the simulation while its
decrease greatly affects population growth and the ancestral lineages
also seem fairly high for more extended periods of time.

### Loyalty Factor

Modifying the loyalty factor does not seem to have an effect on the plotted
value pairs. Such an outcome is to be expected and stems from the definition of
the loyalty factor. This factor determines the likelihood of a Sim to change
their mate for a current reproduction event. It does not affect the population
growth nor does it show any significant impact on the coalescences.

### Average offspring in a lifetime

The increase of this factor just by a fraction leads to much greater population
growth as well as coalescence. Even with small population with a relatively
small set maximum time, the growth rapidly increases. The decrease of the
factor leads to very short simulation often ending in the premature death of
the population. Slight changes to this factor yields drastic changes.

### Scale

Changing the scale affects the age factor which is determined from the ratio
between the scale and the death rate. And so, an increase in the scale, which
leads to an increase of the age factor can be seen as a decrease in the death
rate and the results follow a similar trend as seen in those discussed in the
death rate section, namely that population growth is increased. Similarly, a
decrease in the scale, equivalent to a decrease in the age factor, which can be
seen as an increase in the death rate yields to a decrease in population
growth.